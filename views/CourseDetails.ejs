<!doctype html>
<html lang="en">

<head>
    <title>Course Details</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="../assets/Home/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../assets/Home/css/heroic-features.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Playfair+Display:,300, 400, 700" rel="stylesheet">

    <link rel="stylesheet" href="../assets/CourseDetails/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/CourseDetails/css/animate.css">
    <link rel="stylesheet" href="../assets/CourseDetails/css/owl.carousel.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mediaelement@4.2.7/build/mediaelementplayer.min.css">

    <link rel="stylesheet" href="../assets/CourseDetails/fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="../assets/CourseDetails/fonts/fontawesome/css/font-awesome.min.css">


    <!-- Theme Style -->
    <!-- <link rel="stylesheet" href="CourseDetails/css/style.css"> -->
</head>

<body>
    <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    </nav>
    <!-- <div class="site-wrap">
        <h1 class="p-4">Course Details</h1>
        <main id="course">

        </main>
    </div> -->

    <div>

        <br>
        <br>
        <h1>Course Details</h1>
        <table class="table table-hover table-condensed">
            <thead>
                <tr>
                    <th>Course Details</th>
                    <th>Data</th>
                </tr>
            </thead>

            <tbody>
                <tr>
                    <tr>
                        <td>Course Id:</td>
                        <td id="courseId"><input style="width: 50%;" type="text" id="courseId" name="" value="<%= details[0].courseid%>" readonly></td>
                    </tr>
                </tr>
                <tr>
                    <td>Course Name:</td>
                    <td id="courseName"><input style="width: 50%;" type="text" id="courseName" name="" value="<%= details[0].coursename%>" readonly></td>
                </tr>

                <tr>
                    <td>Instructor Id:</td>
                    <td id="instructorId"><input style="width: 50%;" type="text" id="instructorId" name="" value="<%= details[0].courseteacher%>" readonly></td>
                </tr>
                <!-- 
                <tr>
                    <td>Course Category:</td>
                    <td id="courseCategory"></td>
                </tr> -->

                <tr>
                    <td>Course Description:</td>
                    <td id="courseDescription"><input type="text" style="width: 50%;" id="courseDescription" name="" value="<%= details[0].coursedescription%>" readonly></td>

                </tr>

                <tr>
                    <td>Course Price:</td>
                    <td id="coursePrice"><input type="text" id="coursePrice" name="" value="<%= details[0].coursecost%>" style="width: 50%;" readonly></td>
                </tr>
                <!-- <tr>
                    <td>Course Status:</td>
                    <td id="courseStatus"></td>
                </tr> -->
            </tbody>
        </table>
        <h3>Download Student List</h3>
        <button id="export" class="btn btn-danger">Download Excel</button>
        <h1>Enrolled Student List</h1>


        <table id="StudentList" class="table table-hover table-condensed" border="1">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Email</th>
                    <th>Grade</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <% for(var student of students) { %>
                    <tr>
                        <td>
                            <%=student.id%>
                        </td>
                        <td>
                            <%=student.studentemail%>
                        </td>
                        <td>
                            <%=student.grade%>
                        </td>
                        <td>
                            <%=student.status%>
                        </td>
                    </tr>
                    <% } %>
            </tbody>


        </table>



        <!-- <div id="addToCart">
            <button id="addToCart" class="btn btn-warning">Add To Cart</button>
        </div> -->
    </div>
    <!-- loader -->
    <!-- <div id="loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#f4b214"/></svg></div> -->

    <script src="../assets/CourseDetails/js/jquery-3.2.1.min.js"></script>
    <script src="../assets/CourseDetails/js/popper.min.js"></script>
    <script src="../assets/CourseDetails/js/bootstrap.min.js"></script>
    <script src="../assets/CourseDetails/js/owl.carousel.min.js"></script>
    <script src="../assets/CourseDetails/js/jquery.waypoints.min.js"></script>
    <script src="../assets/CourseDetails/js/jquery.countdown.min.js"></script>
    <script src="../assets/CourseDetails/js/main.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
    <!-- <script type="text/javascript" src="../node_modules/xlsx/dist/xlsx.min.js"></script> -->

    <!-- <script src="../assets/CourseDetails.js"></script> -->
    <script>
        $("#navbar").load("../home/navbar");
    </script>
    <script>
        var wb = XLSX.utils.table_to_book(document.getElementById('StudentList'), {
            sheet: "Sheet JS"
        });
        var wbout = XLSX.write(wb, {
            bookType: 'xlsx',
            bookSST: true,
            type: 'binary'
        });

        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
        // var studentList = document.getElementById('courseName').value;
        $("#export").click(function() {
            saveAs(new Blob([s2ab(wbout)], {
                type: "application/octet-stream"
            }), '<%= details[0].coursename%>.xlsx');
        });
    </script>
    <!-- <script type="text/javascript">
        document.getElementById('export').onclick = function() {
            var tableId = document.getElementById('StudentList').id;

            Excel(tableId, filename = '');
        }

        function Excel(tableId, fileName = '') {
            var downloadedFileName = 'excel_table_data';
            var TableDataType = 'application/vnd.ms-excel';
            var selectTable = document.getElementById(tableId);
            var htmlTable = selectTable.outerHTML.replace(/ /g, '%20');

            filename = filename ? filename + '.xls' : downloadedFileName + '.xls';
            var downloadingURL = document.createElement("a");
            document.body.appendChild(downloadingURL);

            if (navigator.msSaveOrOpenBlob) {
                var blob = new Blob(['\ufeff', htmlTable], {
                    type: TableDataType
                });
                navigator.msSaveOrOpenBlob(blob, fileName);
            } else {

                downloadingURL.href = 'data:' + TableDataType + ', ' + htmlTable;
                downloadingURL.download = fileName;
                downloadingURL.click();
            }
        }
    </script> -->

</body>

</html>